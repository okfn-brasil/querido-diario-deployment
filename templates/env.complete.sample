# Querido Di√°rio - Configura√ß√£o Completa de Ambiente
# ==================================================
#
# Este √© o template MESTRE de ambiente contendo TODAS as vari√°veis
# usadas em todo o ecossistema Querido Di√°rio (API, Backend, Processamento de Dados).
#
# Uso:
#   make setup-env-dev      # Gera .env para desenvolvimento
#   make setup-env-prod     # Gera .env.production para produ√ß√£o
#
# Copie e customize os arquivos gerados de acordo com seu ambiente.

# =============================================================================
# üåê CONFIGURA√á√ÉO DE DOM√çNIO E ROTEAMENTO
# =============================================================================

# Dom√≠nio
DOMAIN=queridodiario.local
# API ser√° acess√≠vel em: api.${DOMAIN}
# Backend ser√° acess√≠vel em: backend-api.${DOMAIN}

# Configura√ß√£o SSL/TLS
CERT_RESOLVER=leresolver

# =============================================================================
# üê≥ CONFIGURA√á√ÉO DE IMAGENS DOCKER
# =============================================================================

API_IMAGE_TAG=latest
BACKEND_IMAGE_TAG=latest
DATA_PROCESSING_IMAGE_TAG=latest
APACHE_TIKA_IMAGE_TAG=latest

# =============================================================================
# üíæ CONFIGURA√á√ÉO DE BANCO DE DADOS
# =============================================================================

# Banco de Dados PostgreSQL Principal (Backend + Processamento de Dados)
POSTGRES_DB=queridodiariodb
POSTGRES_USER=queridodiario
POSTGRES_PASSWORD=queridodiario
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# URL do Banco de Dados Backend (ser√° gerada automaticamente no docker-compose)

# Banco de Dados de Empresas (API)
POSTGRES_COMPANIES_HOST=postgres
POSTGRES_COMPANIES_DB=companiesdb
POSTGRES_COMPANIES_USER=companies
POSTGRES_COMPANIES_PASSWORD=companies
POSTGRES_COMPANIES_PORT=5432

# Banco de Dados de Agregados (API)
POSTGRES_AGGREGATES_HOST=postgres
POSTGRES_AGGREGATES_DB=queridodiariodb
POSTGRES_AGGREGATES_USER=queridodiario
POSTGRES_AGGREGATES_PASSWORD=queridodiario
POSTGRES_AGGREGATES_PORT=5432

# =============================================================================
# üîç CONFIGURA√á√ÉO DO MOTOR DE BUSCA (OpenSearch)
# =============================================================================

# Configura√ß√£o OpenSearch da API
# QUERIDO_DIARIO_OPENSEARCH_HOST ser√° composta automaticamente no docker-compose
# QUERIDO_DIARIO_OPENSEARCH_USER ser√° composta automaticamente no docker-compose
# QUERIDO_DIARIO_OPENSEARCH_PASSWORD ser√° composta automaticamente no docker-compose

# Configura√ß√£o OpenSearch do Processamento de Dados
OPENSEARCH_HOST=http://opensearch:9200
OPENSEARCH_INDEX=querido-diario
OPENSEARCH_USER=admin
OPENSEARCH_PASSWORD=admin

# =============================================================================
# üìÅ CONFIGURA√á√ÉO DE ARMAZENAMENTO DE ARQUIVOS (MinIO/S3)
# =============================================================================

# Conex√£o de Armazenamento
STORAGE_REGION=us-east-1
STORAGE_ENDPOINT=http://minio:9000
STORAGE_ACCESS_KEY=minio-access-key
STORAGE_ACCESS_SECRET=minio-secret-key
STORAGE_BUCKET=queridodiariobucket

# Endpoints de Arquivos
# QUERIDO_DIARIO_FILES_ENDPOINT ser√° composta automaticamente no docker-compose

# =============================================================================
# üì® CONFIGURA√á√ÉO REDIS E CELERY
# =============================================================================

CELERY_BROKER_URL=redis://redis:6378
CELERY_RESULT_BACKEND=redis://redis:6378

# =============================================================================
# üîê CONFIGURA√á√ÉO DE SEGURAN√áA
# =============================================================================

# Chave Secreta do Django Backend (ALTERE EM PRODU√á√ÉO!)
QD_BACKEND_SECRET_KEY=your-super-secret-key-change-in-production

# Modo Debug (DESABILITE EM PRODU√á√ÉO!)
DEBUG=1
QD_BACKEND_DEBUG=True
DATA_PROCESSING_DEBUG=1
QUERIDO_DIARIO_DEBUG=True

# =============================================================================
# üåê CONFIGURA√á√ÉO CORS E HOSTS PERMITIDOS
# =============================================================================

# CORS e Seguran√ßa do Backend
QD_BACKEND_ALLOWED_HOSTS=localhost,backend-api.${DOMAIN},127.0.0.1
QD_BACKEND_ALLOWED_ORIGINS=http://localhost:4200,http://localhost:8000,https://${DOMAIN}
QD_BACKEND_CSRF_TRUSTED_ORIGINS=http://localhost:8000,https://backend-api.${DOMAIN}

# Configura√ß√£o CORS da API
QUERIDO_DIARIO_CORS_ALLOW_ORIGINS=*
QUERIDO_DIARIO_CORS_ALLOW_CREDENTIALS=True
QUERIDO_DIARIO_CORS_ALLOW_METHODS=*
QUERIDO_DIARIO_CORS_ALLOW_HEADERS=*
QUERIDO_DIARIO_ENABLE_CORS=True

# =============================================================================
# üìß CONFIGURA√á√ÉO DE EMAIL (Mailjet)
# =============================================================================

# Configura√ß√£o de Email do Backend
MAILJET_API_KEY=your-mailjet-api-key
MAILJET_SECRET_KEY=your-mailjet-secret-key
DEFAULT_FROM_EMAIL=noreply@queridodiario.local
SERVER_EMAIL=server@queridodiario.local
QUOTATION_TO_EMAIL=quotes@queridodiario.local

# Configura√ß√£o de Email de Sugest√µes da API
QUERIDO_DIARIO_SUGGESTION_SENDER_NAME=Querido Di√°rio
QUERIDO_DIARIO_SUGGESTION_RECIPIENT_NAME=Querido Di√°rio Team
QUERIDO_DIARIO_SUGGESTION_RECIPIENT_EMAIL=team@queridodiario.local
QUERIDO_DIARIO_SUGGESTION_MAILJET_CUSTOM_ID=querido-diario-suggestions

# =============================================================================
# üîß CONFIGURA√á√ÉO DA APLICA√á√ÉO
# =============================================================================

# Configura√ß√£o Django
DJANGO_SETTINGS_MODULE=config.settings

# URLs da Aplica√ß√£o
QD_API_URL=http://querido-diario-api:8080
QD_API_THEME=Tecnologias%20na%20Educa√ß√£o
STATIC_URL=https://backend-api.${DOMAIN}/api/static/
# TODO: Verificar se "localhost:4200" pode ser substitu√≠do por "${DOMAIN}"
# quando testando local
FRONT_BASE_URL=https://${DOMAIN}

# Roteamento da API
QUERIDO_DIARIO_API_ROOT_PATH=
QUERIDO_DIARIO_URL_PREFIX=

# Processamento de Dados
EXECUTION_MODE=ALL
PROJECT_TITLE=Querido Di√°rio

# Configura√ß√£o de Alertas
ALERT_HOUR=1
ALERT_MINUTE=0

# =============================================================================
# üìÑ CONFIGURA√á√ÉO DE ARQUIVOS DE DADOS
# =============================================================================

CITY_DATABASE_CSV=censo.csv
THEMES_DATABASE_JSON=themes_config.json

# =============================================================================
# üîß CONFIGURA√á√ÉO DE EXTRA√á√ÉO DE TEXTO
# =============================================================================

APACHE_TIKA_SERVER=http://apache-tika:9998

# =============================================================================
# üíæ LIMITES DE RECURSOS (Produ√ß√£o)
# =============================================================================

# Limites de Mem√≥ria
API_MEMORY_LIMIT=1G
API_MEMORY_RESERVATION=512M
BACKEND_MEMORY_LIMIT=1G
BACKEND_MEMORY_RESERVATION=512M
CELERY_BEAT_MEMORY_LIMIT=512M
CELERY_BEAT_MEMORY_RESERVATION=256M
CELERY_WORKER_MEMORY_LIMIT=1G
CELERY_WORKER_MEMORY_RESERVATION=512M
CELERY_WORKER_REPLICAS=1
DATA_PROCESSING_MEMORY_LIMIT=2G
DATA_PROCESSING_MEMORY_RESERVATION=1G
APACHE_TIKA_MEMORY_LIMIT=2G
APACHE_TIKA_MEMORY_RESERVATION=1G
REDIS_MEMORY_LIMIT=256M
REDIS_MEMORY_RESERVATION=128M

# Configura√ß√£o de Workers
BACKEND_WORKERS=2

# =============================================================================
# üîç CONFIGURA√á√ÉO DE CAMPOS (Avan√ßado)
# =============================================================================

# Configura√ß√£o de Campos da Gazeta
GAZETTE_CONTENT_FIELD=source_text
GAZETTE_CONTENT_EXACT_FIELD_SUFFIX=.exact
GAZETTE_PUBLICATION_DATE_FIELD=date
GAZETTE_SCRAPED_AT_FIELD=scraped_at
GAZETTE_TERRITORY_ID_FIELD=territory_id

# Configura√ß√£o de Trechos Tem√°ticos
THEMED_EXCERPT_CONTENT_FIELD=excerpt
THEMED_EXCERPT_CONTENT_EXACT_FIELD_SUFFIX=.exact
THEMED_EXCERPT_PUBLICATION_DATE_FIELD=source_date
THEMED_EXCERPT_SCRAPED_AT_FIELD=source_scraped_at
THEMED_EXCERPT_TERRITORY_ID_FIELD=source_territory_id
THEMED_EXCERPT_ENTITIES_FIELD=excerpt_entities
THEMED_EXCERPT_SUBTHEMES_FIELD=excerpt_subthemes
THEMED_EXCERPT_EMBEDDING_SCORE_FIELD=excerpt_embedding_score
THEMED_EXCERPT_TFIDF_SCORE_FIELD=excerpt_tfidf_score
THEMED_EXCERPT_FRAGMENT_SIZE=10000
THEMED_EXCERPT_NUMBER_OF_FRAGMENTS=1

# =============================================================================
# üèóÔ∏è RESTAURA√á√ÉO DE BANCO DE DADOS (Opcional)
# =============================================================================

DATABASE_RESTORE_FILE=

# =============================================================================
# üîÑ SOBRESCRITAS DE PRODU√á√ÉO
# =============================================================================
# A se√ß√£o a seguir cont√©m sobrescritas de produ√ß√£o comentadas.
# Estas ser√£o automaticamente descomentadas e configuradas ao gerar
# arquivos de ambiente de produ√ß√£o.

# PRODUCTION-START
# # Seguran√ßa de Produ√ß√£o (descomentado em produ√ß√£o)
# DEBUG=0
# QD_BACKEND_DEBUG=False
# DATA_PROCESSING_DEBUG=0
# QUERIDO_DIARIO_DEBUG=False
#
# # Dom√≠nios de Produ√ß√£o (descomentado em produ√ß√£o)
# DOMAIN=queridodiario.ok.org.br
# # API ser√° acess√≠vel em: api.${DOMAIN}
# # Backend ser√° acess√≠vel em: backend-api.${DOMAIN}
#
# # Bancos de Dados de Produ√ß√£o (servi√ßos externos)
# POSTGRES_HOST=external-postgres.example.com
# POSTGRES_COMPANIES_HOST=external-postgres.example.com
# POSTGRES_AGGREGATES_HOST=external-postgres.example.com
#
# # OpenSearch de Produ√ß√£o (servi√ßo externo)
# QUERIDO_DIARIO_OPENSEARCH_HOST=external-opensearch.example.com:9200
# OPENSEARCH_HOST=https://external-opensearch.example.com:9200
#
# # Armazenamento de Produ√ß√£o (servi√ßo externo)
# STORAGE_ENDPOINT=https://storage.example.com
# QUERIDO_DIARIO_FILES_ENDPOINT=https://storage.example.com/bucket/
#
# # URLs de Produ√ß√£o
# STATIC_URL=https://backend-api.${DOMAIN}/api/static/
# FRONT_BASE_URL=https://${DOMAIN}
#
# # CORS de Produ√ß√£o
# QD_BACKEND_ALLOWED_HOSTS=backend-api.${DOMAIN},${DOMAIN}
# QD_BACKEND_ALLOWED_ORIGINS=https://${DOMAIN},https://backend-api.${DOMAIN}
# QD_BACKEND_CSRF_TRUSTED_ORIGINS=https://backend-api.${DOMAIN}
# QUERIDO_DIARIO_CORS_ALLOW_ORIGINS=https://${DOMAIN}
#
# # Email de Produ√ß√£o
# DEFAULT_FROM_EMAIL=noreply@${DOMAIN}
# SERVER_EMAIL=server@${DOMAIN}
# QUOTATION_TO_EMAIL=quotes@${DOMAIN}
# QUERIDO_DIARIO_SUGGESTION_RECIPIENT_EMAIL=team@${DOMAIN}
#
# # Workers de Produ√ß√£o
# CELERY_WORKER_REPLICAS=2
# PRODUCTION-END
